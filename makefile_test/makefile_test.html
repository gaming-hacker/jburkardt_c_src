<html>

  <head>
    <title>
      makefile_test
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      makefile_test
    </h1>

    <hr>

    <p>
      <b>makefile_test</b>,
      C programs which 
      contains some examples of how a makefile can
      be used to manage the compilation and loading of a C program.
    </p>

    <p>
      A makefile is usually stored in a file named <i>makefile</i>.
    </p>

    <p>
      The purpose of a makefile is to record or infer the commands
      necessary to compile and load a program (or, more generally,
      to "build" a program or object that depends on objects),
      to intelligently automate this task, and to efficiently
      update all objects that depend on an object that has itself
      just been updated.
    </p>

    <p>
      The most natural example for which a makefile is useful would
      involve the relationship between several text files containing
      C routines (with extension ".c"),
      the object files created by compiling separately each C file
      (with extension ".o"), and the executable program that can be
      created by loading them all together (which, by default, is
      called "a.out", but which we will rename to "c_simple".
    </p>

    <p>
      We suppose we start with C source code files <i>c_simple.c</i>, 
      <i>midpoint.c</i>, and <i>f.c</i>, and an include file
      <i>c_simple.h</i>.  If we wished to build the 
      executable <i>c_simple</i>, we need to create <i>c_simple.o</i>,
      <i>midpoint.o</i>, <i>f.o</i>, and then load them together,
      and rename the result to <i>c_simple</i>.
    </p>

    <p>
      The "dependencies" or relationships between these files can
      be thought of as follows:
      <pre>
        <b>c_simple</b> needs <i>c_simple.o</i>, <i>midpoint.o</i> and <i>f.o</i>.
          The commands to create <b>c_simple</b> are
          gcc c_simple.o midpoint.o sub2.o
          mv a.out c_simple
     
        <b>c_simple.o</b> needs <i>c_simple.c</i> and <i>c_simple.h</i>.
          The command to create <b>c_simple.o</b> is
          gcc -c c_simple.c

        <b>midpoint.o</b> needs <i>midpoint.c</i> and <i>c_simple.h</i>.
          The command to create <b>midpoint.o</b> is
          gcc -c midpoint.c

        <b>f.o</b> needs <i>f.c</i> and <i>c_simple.h</i>.
          The command to create <b>f.o</b> is
          gcc -c f.c
      </pre>
    </p>

    <p>
      The corresponding makefile records these relationships.  Each 
      <i>dependency line</i> lists a "target" (something you want to make), 
      followed by a colon, and then a list of the components on which that 
      target depends.  There follow one or more <i>command lines</i> that 
      tell how to put the components together to make the target.  Note 
      that each command line must begin with a TAB character.  We will
      use the symbol <b>--TAB--&gt;</b> to suggest this.  Here is what the 
      makefile would look like
      <pre>
        <b>c_simple</b> : <i>c_simple.o</i> <i>midpoint.o</i> <i>f.o</i>
        <i>--TAB--&gt;</i> gcc c_simple.o midpoint.o f.o
        <i>--TAB--&gt;</i> mv a.out c_simple
        <b>c_simple.o</b> : <i>c_simple.c</i> <i>c_simple.h</i>
        <i>--TAB--&gt;</i> gcc -c c_simple.c
        <b>midpoint.o</b> : <i>midpoint.c</i> <i>c_simple.h</i>
        <i>--TAB--&gt;</i> gcc -c midpoint.c
        <b>f.o</b> : <i>f.c</i> <i>c_simple.h</i>
        <i>--TAB--&gt;</i> gcc -c f.c
      </pre>
    </p>

    <p>
      To create the program, type <i>make c_simple</i>.  If you just 
      edited <b>midpoint.c</b> and want only to recompile it, type 
      <i>make midpoint.o</i>.  But if you just edited <b>midpoint.c</b>, 
      and you want to recompile it, and then also recreate the program, 
      then type <i>make c_simple</i>.  The <b>make</b> program will notice 
      that <i>midpoint.c</i> has been updated, and automatically 
      recompile it, and then rebuild <b>c_simple</b>.
    </p>

    <h3 align = "center">
      Licensing:
    </h3>

    <p>
      The computer code and data files described and made available on this web page
      are distributed under
      <a href = "https://www.gnu.org/licenses/lgpl-3.0.en.html">the GNU LGPL license.</a>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>makefile_test</b> is available in
      <a href = "../../c_src/makefile_test/makefile_test.html">a C version</a>,
      <a href = "../../cpp_src/makefile_test/makefile_test.html">a C++ version</a> and
      <a href = "../../f_src/makefile_test/makefile_test.html">a FORTRAN90 version</a>.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Robert Mecklenburg,<br>
          Managing Projects with GNU Make,<br>
          O'Reilly, 2004,<br>
          ISBN: 0596006101.
        </li>
        <li>
          Steve Talbot,<br>
          Managing Projects with Make,<br>
          O'Reilly, 1990,<br>
          ISBN: 0-937-175-18-8.
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "c_simple/c_simple.html">a simple C example</a>
        </li>
      </ul>
    </p>

    <hr>

    <i>
      Last revised on 13 July 2019.
    </i>

    <!-- John Burkardt -->
 
  </body>

</html>
